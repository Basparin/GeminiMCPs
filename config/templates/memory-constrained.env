# CodeSage MCP Server - Memory-Constrained Environment Configuration
# =================================================================
# This configuration is optimized for environments with limited memory
# while maintaining good performance through aggressive optimization.

# =================================================================
# LLM API CONFIGURATION
# =================================================================

# Primary LLM Provider (choose one - efficient models)
GROQ_API_KEY="your-memory-efficient-groq-api-key"
# OPENROUTER_API_KEY="your-memory-efficient-openrouter-api-key"
# GOOGLE_API_KEY="your-memory-efficient-google-api-key"

# =================================================================
# PERFORMANCE & MEMORY CONFIGURATION
# =================================================================

# Memory Management (Constrained Resources)
CODESAGE_MEMORY_LIMIT=128MB
CODESAGE_MAX_MEMORY_MB=256
CODESAGE_ENABLE_MEMORY_MONITORING=true
CODESAGE_MEMORY_CHECK_INTERVAL=20

# Model Optimization (Maximum Efficiency)
CODESAGE_ENABLE_MODEL_QUANTIZATION=true
CODESAGE_MODEL_CACHE_TTL_MINUTES=15
CODESAGE_ENABLE_MEMORY_MAPPED_INDEXES=true

# =================================================================
# CACHING CONFIGURATION
# =================================================================

# Cache Sizes (Minimal Memory Usage)
CODESAGE_EMBEDDING_CACHE_SIZE=1000
CODESAGE_SEARCH_CACHE_SIZE=500
CODESAGE_FILE_CACHE_SIZE=50

# Cache Behavior (Aggressive Optimization)
CODESAGE_SIMILARITY_THRESHOLD=0.7
CODESAGE_MAX_FILE_SIZE_MB=0.25
CODESAGE_CACHE_PERSISTENCE_ENABLED=true
CODESAGE_CACHE_WARMING_ENABLED=false

# Adaptive Features (Conservative)
CODESAGE_ADAPTIVE_CACHE_ENABLED=true
CODESAGE_MEMORY_THRESHOLD_HIGH=0.7
CODESAGE_MEMORY_THRESHOLD_LOW=0.4

# =================================================================
# PROCESSING CONFIGURATION
# =================================================================

# Parallel Processing (Minimal)
CODESAGE_PARALLEL_WORKERS=1
CODESAGE_BATCH_SIZE=10
CODESAGE_MAX_FILE_SIZE_MB=0.25

# Index Optimization (Maximum Compression)
CODESAGE_INDEX_COMPRESSION=true
CODESAGE_INDEX_COMPRESSION_TYPE=scalar_quant
CODESAGE_INDEX_TYPE=flat
CODESAGE_FAISS_NLIST_AUTO=false

# =================================================================
# SEARCH CONFIGURATION
# =================================================================

# Search Parameters (Conservative)
CODESAGE_DEFAULT_TOP_K=3
CODESAGE_MAX_TOP_K=5
CODESAGE_SEMANTIC_SEARCH_ENABLED=true
CODESAGE_TEXT_SEARCH_ENABLED=true

# Search Optimization (Efficient)
CODESAGE_SEARCH_CACHE_ENABLED=true
CODESAGE_SEARCH_CACHE_SIZE=200
CODESAGE_SEARCH_CACHE_SIMILARITY_THRESHOLD=0.7

# =================================================================
# LOGGING & MONITORING
# =================================================================

# Logging (Minimal)
CODESAGE_LOG_LEVEL=WARNING
CODESAGE_LOG_FORMAT=text
CODESAGE_LOG_FILE=logs/codesage_memory.log
CODESAGE_LOG_MAX_SIZE=50MB
CODESAGE_LOG_BACKUP_COUNT=2

# Performance Logging (Essential Only)
CODESAGE_PERFORMANCE_LOGGING_ENABLED=false
CODESAGE_SLOW_QUERY_THRESHOLD=2.0

# Monitoring (Lightweight)
CODESAGE_HEALTH_CHECK_ENABLED=true
CODESAGE_METRICS_PORT=9092
CODESAGE_PERFORMANCE_MONITORING_ENABLED=false
CODESAGE_METRICS_COLLECTION_INTERVAL=120

# =================================================================
# MEMORY OPTIMIZATION FEATURES
# =================================================================

# Aggressive Memory Management
CODESAGE_AGGRESSIVE_MEMORY_CLEANUP=true
CODESAGE_MEMORY_CLEANUP_INTERVAL=60
CODESAGE_FORCE_GC_ON_MEMORY_PRESSURE=true

# Cache Compression
CODESAGE_CACHE_COMPRESSION_ENABLED=true
CODESAGE_CACHE_COMPRESSION_TYPE=lz4
CODESAGE_CACHE_COMPRESSION_LEVEL=1

# Index Memory Optimization
CODESAGE_INDEX_MEMORY_OPTIMIZATION=true
CODESAGE_INDEX_LOAD_MODE=memory_mapped
CODESAGE_INDEX_UNLOAD_UNUSED=true

# =================================================================
# EFFICIENCY FEATURES
# =================================================================

# Processing Efficiency
CODESAGE_ENABLE_PROCESSING_OPTIMIZATION=true
CODESAGE_CHUNK_SIZE=500
CODESAGE_CHUNK_OVERLAP=50
CODESAGE_MAX_CHUNKS_PER_FILE=10

# Network Efficiency
CODESAGE_ENABLE_COMPRESSION=true
CODESAGE_COMPRESSION_LEVEL=6
CODESAGE_CONNECTION_POOL_SIZE=5

# =================================================================
# INTEGRATION SETTINGS
# =================================================================

# Gemini CLI Integration (Lightweight)
CODESAGE_MCP_SERVER_NAME=codesage-light
CODESAGE_MCP_SERVER_URL=http://localhost:8000

# =================================================================
# MEMORY-CONSTRAINED NOTES
# =================================================================
# - This configuration is optimized for minimal memory usage
# - Suitable for systems with 256MB-512MB RAM
# - Aggressive optimization may impact performance
# - Recommended for resource-constrained environments
#
# Memory Usage Targets:
# - Base memory: <50MB
# - With indexing: <128MB
# - With caching: <200MB
# - Peak usage: <256MB
#
# Performance Characteristics:
# - Response time: 100ms-500ms (slower than optimized configs)
# - Throughput: 10-50 requests per minute
# - Cache hit rate: 60-80%
# - Memory efficiency: 95%+
#
# Trade-offs:
# - Reduced cache sizes may lower hit rates
# - Aggressive compression may increase CPU usage
# - Smaller batches may reduce throughput
# - Limited parallel processing
#
# For better performance with more memory, see:
# - config/templates/production.env (balanced)
# - config/templates/development.env (debug features)
#
# System Requirements:
# - RAM: 256MB minimum, 512MB recommended
# - CPU: 1+ core (2+ cores recommended)
# - Storage: 1GB+ free space
# - Network: Stable connection for LLM APIs